# Модуль А: «Пусконаладка инфраструктуры на основе OC семейства Linux»

# ИНСТРУКЦИИ  ДЛЯ УЧАСТНИКА

В первую очередь необходимо прочитать задание полностью.

Следует обратить внимание, что задание составлено не в хронологическом порядке. Некоторые секции могут потребовать действий из других секций, которые изложены ниже.

На вас возлагается ответственность за распределение своего рабочего времени. Не тратьте время, если у вас возникли проблемы с некоторыми заданиями. Вы можете использовать временные решения (если у вас есть зависимости в технологическом стеке) и продолжить выполнение других задач.

Рекомендуется тщательно проверять результаты своей работы.

-----

**Доступ ко всем виртуальным машинам настроен по аккаунту root:toor.**

**Если Вам требуется установить пароль, (и он не указан в задании) используйте: “P@ssw0rd”.**

**Виртуальная машина ISP преднастроена. Управляющий доступ участника к данной виртуальной машине для выполнения задания не предусмотрен. При попытке его сброса возникнут проблемы.**

**Участники не имеют права пользоваться любыми устройствами, за исключением находящихся на рабочих местах устройств, предоставленных организаторами.**

**Участники не имеют права приносить с собой на рабочее место заранее подготовленные текстовые материалы.**

**В итоге участники должны обеспечить наличие и функционирование в соответствии с заданием служб и ролей на указанных виртуальных машинах. При этом участники могут самостоятельно выбирать способ настройки того или иного компонента, используя предоставленные им ресурсы по своему усмотрению.**

**Проверка будет осуществляться по dns-именам!**

**Помните, что после окончания выполнения задания все устройства будут ПЕРЕЗАГРУЖЕНЫ!**

----


# СХЕМА ОЦЕНКИ
Каждый субкритерий имеет приблизительно одинаковый вес. Пункты внутри каждого критерия имеют разный вес, в зависимости от сложности пункта и количества пунктов в субкритерии.

Схема оценка построена таким образом, чтобы каждый пункт оценивался только один раз. Например, в секции «Базовая конфигурация» предписывается настроить имена для всех устройств, однако этот пункт будет проверен только на одном устройстве и оценен только 1 раз.

Одинаковые пункты могут быть проверены и оценены больше чем 1 раз, если для их выполнения применяются разные настройки или они выполняются на разных классах устройств.

Подробное описание методики проверки должно быть разработано экспертами, принимавшими участие в оценке конкурсного задания чемпионата, и вынесено в отдельный документ. Данный документ, как и схема оценки, является объектом внесения 30% изменений.


1.	Выполните базовую конфигурацию виртуальных машин, необходимую для сетевого взаимодействия

2.	Выполните на BR-RTR настройку DHCP-сервера для сети BR
 * Пул адресов для сети BR: 192.168.2.50-192.168.2.100
 *	В качестве DNS сервера укажите адрес BR-SRV1
 *	Сервера должны получать статические ip-адреса по dhcp
 *	Обеспечьте автоматическое обновление dns зоны rea2023.ru, в том числе статических адресов

 3. Выполните на BR-SRV1 настройку DNS сервера
  * Настройте зону rea2023.ru
  * Настройте сопоставление имен в соответствии с Таблицей 1
  * Файлы зон должны храниться в /opt/rea2023/
  * Создайте запись test.rea2023.ru, таким образом, чтобы из подсети офиса BR происходило разрешение в адрес 1.1.1.1,  а со всех остальных хостов в адрес 2.2.2.2
  * Обеспечьте подпись обновлений от DHCP сервера с использованием dnssec
  * Все запросы к домену itnsa.lab должны быть перенаправлены на 10.113.38.100

4.	На пограничных маршрутизаторах сконфигурируйте межсетевой экран при помощи пакета nftables

* Обеспечьте возможность доступа во внешние сети всем устройствам во внутренних сетях
* Трафик из внешних сетей не должен попадать во внутренние
* При попытке проверки доступности любых из пограничных маршрутизаторов клиент должен получать сообщение “icmp rejected”
* Запретите входящий трафик на все порты, кроме тех, которые используются
* На маршрутизаторе CR-RTR сконфигурируйте перенаправление трафика с порта 2222 на стандартный ssh порт сервера CR-SRV

5.	Между пограничными маршрутизаторами организовано Site to Site VPN соединение в файле /etc/gre.up, но на данном этапе оно неработоспособно. Необходимо восстановить работоспособность соединения.

* Известно, что соединение было защищено при помощи набора утилит strongswan. Защиту соединения необходимо сохранить.

6.	Настройте динамическую маршрутизацию по протоколу OSPF используя пакет FRR

*  Применение статических маршрутов не допускается

7.	Разверните LDAP-сервер на базе Freeipa

* В качестве сервера используйте CR-SRV
* Создайте учетные записи и группы в соответствии с Таблицей 2
* BR-CLI и CR-CLI должны аутентифицироваться через LDAP
* В качестве имени домена LDAP используйте rea2023.ru
* Пользователи группы branch имеют право аутентификации только на BR-CLI
* Пользователи группы main должны иметь возможность повышать привилегии
* Пользователи группы branch должны иметь возможность выполнять команды из списка. Доступ к другим командам необходимо ограничить:
      - **ls**
      - **grep**
      - **head**
      - **tail**

8.	Реализуйте перемещаемые профили для пользователей. При входе на другом компьютере пользователь должен получать доступ ко всем своим данным.

9.	Реализуйте общие каталоги для пользователей

* Реализуйте папку обмена. Все пользователи имеют права чтения и записи на эту папку. Запретите пользователям удалять файлы и папки, владельцами которых они не являются. Папку необходимо смонтировать на рабочий стол, с названием Share.

* Реализуйте папку хранения рабочих документов. Доступ для записи необходимо предоставить только группе branch, остальным пользователям разрешен доступ для чтения. Папку необходимо смонтировать на рабочий стол, с названием Docs.

10. Пользователи при входе должны автоматически получать kerberos билет

11. На сервере BR-SRV2 настройте локальный веб-сайт с содержимым

* Сконфигурируйте ресурс https://web.rea2023.ru с содержимым “Welcome to “ReaSkills2023”

* Сконфигурируйте ресурс https://webfiles.rea2023.ru/secret с содержимым “Welcome to our secret files!

* При попытке доступа к корню содержимого ресурса webfiles должно происходить перенаправление на https://web.rea2023.ru

* Сконфигурируйте аутентификацию для доступа только к разделу /secret. 

* Аутентификация должна предусматривать доступ к ресурсу только доменных пользователей. Пользователи, не являющиеся доменными, не должны иметь возможность аутентификации на ресурсе

* При попытке доступа к ресурсу по IP адресу пользователь должен получать ошибку 404


12. На виртуальной машине OUT-CLI заполнен LVM том. Необходимо его расширить. Для расширения раздела используйте примонтированный к виртуальной машине диск /dev/vdc. Расширьте том на 50% объема нового диска.

13.	На виртуальной машине OUT-CLI создайте новый LVM том. Том должен занимать весь свободный обьем существующей группы томов.

Том необходимо зашифровать.

 В качестве пароля для шифрования том используйте xxXX1122. Обеспечьте автоматическое монтирование тома при старте системы.

 В качестве точки монтирования используйте /mnt/secured

14. На пограничном маршрутизаторе CR-RTR сконфигурируйте сервер удаленного доступа WireGuard.

15. Сконфигурируйте клиент удаленного доступа на виртуальной машине OUT-CLI. Клиент должен автоматически устанавливать соединение при загрузке системы. Обеспечьте доступ клиента к доменным ресурсам обоих офисов с использованием доменных имен. Добавьте виртуальную машину в домен.

16. На сервере BR-SRV1 реализуйте сервер сбора журналов.

* Необходимо собрать логи уровня *.err и ниже

* Сбор логов необходимо производить с устройств BR-RTR и CR-RTR

* Хранить логи необходимо в /opt/logs/<hostname>/error.log

* Реализуйте ротацию журналов. При достижении размера 10МБ, журнал необходимо архивировать. Необходимо хранить не более трех архивных копий журналов.


17. На сервере BR-SRV1 реализуйте центр сертификации.

* В качестве CN используйте REA2023

* В качестве корневой директории для центра сертификации используйте каталог /etc/ca

* Все устройства должны доверять данному центру сертификации, как на уровне системы, так и в браузере Mozilla Firefox, в почтовом клиенте mozilla thunderbird.

18. На сервере BR-SRV2 реализуйте почтовый сервер

* Соединение с почтовым сервером должно быть защищено. Клиент не должен получать ошибок в почтовом клиенте.

* Обеспечьте возможность аутентификации с использованием доменных учетных данных.

* 	Обеспечьте возможность отправки писем. От имени пользователя user1 на CR-CLI отправьте письмо пользователю user11 на BR-CLI

* В качестве почтового клиента используйте Mozilla Thunderbird.

* При входе пользователь должен указывать только свое имя и почтовый домен. Почтовый клиент не должен требовать ввода данных почтового сервера

19. На сервере BR-SRV1 разверните zabbix. Архив с заббиксом можно установить с ISP (Название архива – zabbix.zip).

 + Обеспечьте защищенное соединение, при попытке доступа по протоколу http должно происходить перенаправление на https

 + Обеспечьте аутентификацию при помощи LDAP для пользователей user1-user3

 + Сконфигурируйте мониторинг хостов BR-RTR и CR-RTR:
